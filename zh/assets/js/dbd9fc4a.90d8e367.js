"use strict";(self.webpackChunkopenkruise_io=self.webpackChunkopenkruise_io||[]).push([[3984],{3905:function(t,e,n){n.d(e,{Zo:function(){return d},kt:function(){return s}});var a=n(7294);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(null==t)return{};var n,a,l=function(t,e){if(null==t)return{};var n,a,l={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(l[n]=t[n]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(l[n]=t[n])}return l}var u=a.createContext({}),o=function(t){var e=a.useContext(u),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},d=function(t){var e=o(t.components);return a.createElement(u.Provider,{value:e},t.children)},m={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},k=a.forwardRef((function(t,e){var n=t.components,l=t.mdxType,r=t.originalType,u=t.parentName,d=p(t,["components","mdxType","originalType","parentName"]),k=o(n),s=l,N=k["".concat(u,".").concat(s)]||k[s]||m[s]||r;return n?a.createElement(N,i(i({ref:e},d),{},{components:n})):a.createElement(N,i({ref:e},d))}));function s(t,e){var n=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=n.length,i=new Array(r);i[0]=k;var p={};for(var u in e)hasOwnProperty.call(e,u)&&(p[u]=e[u]);p.originalType=t,p.mdxType="string"==typeof t?t:l,i[1]=p;for(var o=2;o<r;o++)i[o]=n[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},1025:function(t,e,n){n.r(e),n.d(e,{assets:function(){return d},contentTitle:function(){return u},default:function(){return s},frontMatter:function(){return p},metadata:function(){return o},toc:function(){return m}});var a=n(7462),l=n(3366),r=(n(7294),n(3905)),i=["components"],p={},u="API \u89c4\u8303",o={unversionedId:"user-manuals/api-specifications",id:"user-manuals/api-specifications",title:"API \u89c4\u8303",description:"Kruise Rollouts \u8d44\u6e90 YAML \u7684\u57fa\u672c\u793a\u4f8b\uff1a",source:"@site/i18n/zh/docusaurus-plugin-content-docs-rollouts/current/user-manuals/api-specifications.md",sourceDirName:"user-manuals",slug:"/user-manuals/api-specifications",permalink:"/zh/rollouts/user-manuals/api-specifications",draft:!1,tags:[],version:"current",lastUpdatedBy:"Bob",lastUpdatedAt:1698374629,formattedLastUpdatedAt:"2023/10/27",frontMatter:{},sidebar:"rollouts",previous:{title:"\u5b89\u88c5",permalink:"/zh/rollouts/installation"},next:{title:"\u57fa\u672c\u4f7f\u7528\u6307\u5357",permalink:"/zh/rollouts/user-manuals/basic-usage"}},d={},m=[{value:"API \u8be6\u7ec6\u4fe1\u606f",id:"api-\u8be6\u7ec6\u4fe1\u606f",level:2},{value:"\u5de5\u4f5c\u8d1f\u8f7d\u7ed1\u5b9a API\uff08\u5fc5\u586b\uff09",id:"\u5de5\u4f5c\u8d1f\u8f7d\u7ed1\u5b9a-api\u5fc5\u586b",level:3},{value:"\u6d41\u91cf\u7ed1\u5b9a API\uff08\u53ef\u9009\uff09",id:"\u6d41\u91cf\u7ed1\u5b9a-api\u53ef\u9009",level:3},{value:"\u7b56\u7565API\uff08\u5fc5\u586b\uff09",id:"\u7b56\u7565api\u5fc5\u586b",level:3},{value:"Rollout\u7684\u7279\u6b8a\u6ce8\u91ca\uff08\u53ef\u9009\uff09",id:"rollout\u7684\u7279\u6b8a\u6ce8\u91ca\u53ef\u9009",level:3},{value:"\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u6b8a\u6ce8\u91ca\uff08\u53ef\u9009\uff09",id:"\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u6b8a\u6ce8\u91ca\u53ef\u9009",level:3},{value:"\u60a8\u5e94\u8be5\u4e86\u89e3\u7684Rollout\u72b6\u6001",id:"\u60a8\u5e94\u8be5\u4e86\u89e3\u7684rollout\u72b6\u6001",level:3}],k={toc:m};function s(t){var e=t.components,n=(0,l.Z)(t,i);return(0,r.kt)("wrapper",(0,a.Z)({},k,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"api-\u89c4\u8303"},"API \u89c4\u8303"),(0,r.kt)("p",null,"Kruise Rollouts \u8d44\u6e90 YAML \u7684\u57fa\u672c\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: rollouts.kruise.io/v1alpha1\nkind: Rollout\nmetadata:\n  name: rollouts-demo\n  # Rollout \u8d44\u6e90\u9700\u8981\u4e0e\u76f8\u5e94\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5728\u76f8\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\n  namespace: defaults\n  # \u6b64\u6ce8\u91ca\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u4f7f\u7528\u5206\u533a\u5347\u7ea7 Deployment\uff0c\u7c7b\u4f3c\u4e8e StatefulSet/CloneSet\u3002\n  annotations:\n    rollouts.kruise.io/rolling-style: partition\nspec:\n  objectRef:\n    # \u53d1\u5e03\u5de5\u4f5c\u8d1f\u8f7d\u7684 Rollout\uff0c\u5f53\u524d\u4ec5\u652f\u6301 Deployment\u3001CloneSet\u3001StatefulSet\u3001Advanced StatefulSet\n    workloadRef:\n      apiVersion: apps/v1\n      kind: Deployment\n      name: echoserver\n  strategy:\n    canary:\n      steps:\n      ### \u7b2c\u4e00\u6279 ###\n      # \u5c06 5% \u7684\u6d41\u91cf\u8def\u7531\u5230\u65b0\u7248\u672c\n      - weight: 5\n      # \u9700\u8981\u624b\u52a8\u786e\u8ba4\u624d\u80fd\u8fdb\u5165\u4e0b\u4e00\u6279\n        pause: {}\n      # \u53ef\u9009\uff0c\u53d1\u5e03\u526f\u672c\u7684\u7b2c\u4e00\u6b65\u3002\u5982\u679c\u672a\u8bbe\u7f6e\uff0c\u5219\u9ed8\u8ba4\u4f7f\u7528\u201cweight\u201d\uff0c\u5982\u4e0a\u6240\u793a\u4e3a 5%\u3002\n        replicas: 1\n      ### \u7b2c\u4e8c\u6279 ###\n      - replicas: 50%\n      # \u7b49\u5f85 2 \u5c0f\u65f6\u540e\u81ea\u52a8\u8fdb\u5165\u4e0b\u4e00\u6279\n        pause:\n          duration: 7200\n      ### \u7b2c\u4e09\u6279 ###\n      - replicas: 100%\n      trafficRoutings:\n      # \u4e0e\u5de5\u4f5c\u8d1f\u8f7d\u76f8\u5173\u7684\u670d\u52a1\u540d\u79f0\n      - service: echoserver\n      # \u4e0e\u670d\u52a1\u76f8\u5173\u7684 Ingress \u540d\u79f0\n        ingress:\n          name: echoserver\n")),(0,r.kt)("p",null,"API \u89c4\u8303\u7684\u4e3b\u8981\u90e8\u5206\u5305\u62ec 3 \u90e8\u5206\uff0c\u60a8\u5e94\u8be5\u6ce8\u610f\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7ed1\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\uff1a\u544a\u8bc9 Rollout \u5e94\u8be5\u5728\u54ea\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\u4e0a\u5de5\u4f5c\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u7ed1\u5b9a\u6d41\u91cf\u914d\u7f6e\uff1a\u544a\u8bc9 Rollout \u5e94\u8be5\u5173\u6ce8\u54ea\u4e2a\u6d41\u91cf\u914d\u7f6e\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5728\u53d1\u5e03\u4e4b\u524d\u914d\u7f6e\u90e8\u7f72\u7b56\u7565\uff1a\u544a\u8bc9 Rollout \u5982\u4f55\u6eda\u52a8\u60a8\u7684\u5de5\u4f5c\u8d1f\u8f7d\u548c\u6d41\u91cf\u3002")),(0,r.kt)("h2",{id:"api-\u8be6\u7ec6\u4fe1\u606f"},"API \u8be6\u7ec6\u4fe1\u606f"),(0,r.kt)("h3",{id:"\u5de5\u4f5c\u8d1f\u8f7d\u7ed1\u5b9a-api\u5fc5\u586b"},"\u5de5\u4f5c\u8d1f\u8f7d\u7ed1\u5b9a API\uff08\u5fc5\u586b\uff09"),(0,r.kt)("p",null,"\u544a\u8bc9 Kruise Rollout \u5e94\u8be5\u7ed1\u5b9a\u54ea\u4e2a\u5de5\u4f5c\u8d1f\u8f7d\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: rollouts.kruise.io/v1alpha1\nkind: Rollout\nmetadata:\n  namespace: <your-workload-ns>\nspec:\n  objectRef:\n    workloadRef:\n      apiVersion: apps/v1\n      kind: StatefulSet\n      name: <your-workload-name>\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5b57\u6bb5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"apiVersion")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u7684 API \u7248\u672c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kind")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u79cd\u7c7b")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"name")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u540d\u79f0")))),(0,r.kt)("p",null,"\u76ee\u524d\uff0cKruise Rollout \u652f\u6301 Deployment\u3001CloneSet\u3001StatefulSet \u548cAdvanced StatefulSet\u3002"),(0,r.kt)("p",null,"\u6ce8\u610f\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5de5\u4f5c\u8d1f\u8f7d\u5e94\u8be5\u4e0e Rollout \u5728\u76f8\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u3002")),(0,r.kt)("h3",{id:"\u6d41\u91cf\u7ed1\u5b9a-api\u53ef\u9009"},"\u6d41\u91cf\u7ed1\u5b9a API\uff08\u53ef\u9009\uff09"),(0,r.kt)("p",null,"\u4e0e\u201c\u5de5\u4f5c\u8d1f\u8f7d\u7ed1\u5b9a\u201d\u4e0d\u540c\uff0c\u6d41\u91cf\u7ed1\u5b9a\u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u4ee5\u4e0b\u89c4\u8303\uff0c\u6d41\u91cf\u914d\u7f6e\u5c06\u4fdd\u6301\u5176\u539f\u59cb\u884c\u4e3a\uff0c\u4f8b\u5982\uff0c\u4e3a\u6240\u6709\u7248\u672c\u7684 Pod \u4fdd\u6301\u8d1f\u8f7d\u5747\u8861\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u60a8\u9700\u8981\u4e3a\u6d41\u91cf\u8def\u7531\u6267\u884c\u7279\u6b8a\u64cd\u4f5c\uff0c\u8bf7\u544a\u8bc9 Kruise Rollout \u5e94\u8be5\u7ed1\u5b9a\u54ea\u4e9b\u6d41\u91cf\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rollouts.kruise.io/v1alpha1\nkind: Rollout\nmetadata:\n  namespace: <your-workload-ns>\nspec:\n  trafficRoutings:\n    - service: <service-name-that-is-related-your-workload>\n      ingress:\n        classType: <traffic-type> # \u4f8b\u5982\uff1anginx | higress\uff0c\u9ed8\u8ba4\u4e3a "nginx"\n        name: <ingress-name-that-is-related-the-service>\n      gateway: # \u6216\u8005\u9009\u62e9\u4f7f\u7528 Ingress \u6216 GatewayAPI\n        httpRouteName: <gateway-api-httpRoute-name>\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5b57\u6bb5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"service")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u9009\u62e9\u7ed1\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u670d\u52a1\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u8c61"),(0,r.kt)("td",{parentName:"tr",align:null},"nil"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u60a8\u60f3\u8981\u7ed1\u5b9a\u7684Ingress\u5bf9\u8c61\u7684\u63cf\u8ff0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"gateway")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u8c61"),(0,r.kt)("td",{parentName:"tr",align:null},"nil"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u60a8\u60f3\u8981\u7ed1\u5b9a\u7684",(0,r.kt)("a",{parentName:"td",href:"https://gateway-api.sigs.k8s.io/"},"Gateway API"),"\u8d44\u6e90\u7684\u63cf\u8ff0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.classType")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'"nginx"'),(0,r.kt)("td",{parentName:"tr",align:null},'Ingress\u7c7b\u578b\uff0c\u5982"nginx"\u3001"higress"\u6216\u5176\u4ed6')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.name")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u7ed1\u5b9a\u670d\u52a1\u7684Ingress\u8d44\u6e90\u7684\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"gateway.httpRouteName")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"Gateway API\u7684",(0,r.kt)("a",{parentName:"td",href:"https://gateway-api.sigs.k8s.io/concepts/api-overview/#httproute"},"HTTPRoute"),"\u8d44\u6e90\u540d\u79f0")))),(0,r.kt)("p",null,"\u6ce8\u610f\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u51b3\u5b9a\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"trafficRoutings"),"\uff0c\u5219",(0,r.kt)("inlineCode",{parentName:"li"},"ingress"),"\u548c",(0,r.kt)("inlineCode",{parentName:"li"},"gateway"),"\u4e0d\u80fd\u540c\u65f6\u4e3anil\u3002")),(0,r.kt)("h3",{id:"\u7b56\u7565api\u5fc5\u586b"},"\u7b56\u7565API\uff08\u5fc5\u586b\uff09"),(0,r.kt)("p",null,"\u63cf\u8ff0\u60a8\u7684\u53d1\u5e03\u7b56\u7565\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: rollouts.kruise.io/v1alpha1\nkind: Rollout\nmetadata:\n  namespace: <your-workload-ns>\nspec:\n  strategy:\n    canary:\n      steps:\n        # the first step\n        - weight: 5\n          replicas:\n          pause:\n            duration: 1000\n          matches:\n            - headers:\n                - type: Exact # \u6216\u8005 "RegularExpression"\n                  name: <matched-header-name>\n                  value: <matched-header-value, or reg-expression>\n        # the second step\n        - weight: 10\n          ... ....\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5b57\u6bb5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps[x].weight")),(0,r.kt)("td",{parentName:"tr",align:null},"*\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"nil"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u91d1\u4e1d\u96c0\u6d41\u91cf\u65b0\u7248\u672cPod\u7684\u767e\u5206\u6bd4\u6743\u91cd\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps[x].replicas")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"td"},"\u6574\u6570\u6216"),"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"nil"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u65b0\u7248\u672cPod\u7684\u7edd\u5bf9\u6570\u91cf\u6216\u767e\u5206\u6bd4\u3002\u5982\u679c\u4e3anil\uff0c\u5219\u9ed8\u8ba4\u4f7f\u7528'weight'\u4f5c\u4e3a\u526f\u672c\u6570\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps[x].pause")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u8c61"),(0,r.kt)("td",{parentName:"tr",align:null},"{}"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u8fdb\u5165\u4e0b\u4e00\u6b65\u4e4b\u524d\u9700\u8981\u624b\u52a8\u786e\u8ba4\u6216\u81ea\u52a8\u786e\u8ba4\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps[x].pause.duration")),(0,r.kt)("td",{parentName:"tr",align:null},"*\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"nil"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u81ea\u52a8\u786e\u8ba4\u4e4b\u524d\u7684\u6301\u7eed\u65f6\u95f4\u3002\u5982\u679c\u4e3anil\uff0c\u5219\u8868\u793a\u9700\u8981\u624b\u52a8\u786e\u8ba4\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps[x].matches")),(0,r.kt)("td",{parentName:"tr",align:null},"[]\u5bf9\u8c61"),(0,r.kt)("td",{parentName:"tr",align:null},"[]"),(0,r.kt)("td",{parentName:"tr",align:null},"\uff08\u53ef\u9009\uff09\u60a8\u60f3\u8981\u5c06\u6d41\u91cf\u5f15\u5bfc\u5230\u65b0\u7248\u672cPod\u7684HTTP\u6807\u5934\u5339\u914d\u89c4\u5219\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"headers[x].type")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'"Exact"'),(0,r.kt)("td",{parentName:"tr",align:null},'\u5339\u914d\u952e\u548c\u503c\u7684\u89c4\u5219\uff0c\u53ef\u4ee5\u662f"Exact"\u6216"RegularExpression"\u3002')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"headers[x].name")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u7684HTTP\u6807\u5934\u540d\u79f0\u3002\uff08headers","[i]","\u548cheaders","[j]","\u4e4b\u95f4\u7684And\u5173\u7cfb\uff09")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"headers[x].value")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u5339\u914d\u7684HTTP\u6807\u5934\u503c\u3002")))),(0,r.kt)("p",null,"\u6ce8\u610f\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"steps[x].weight"),"\u548c",(0,r.kt)("inlineCode",{parentName:"li"},"steps[x].replicas"),"\u4e0d\u80fd\u540c\u65f6\u4e3anil\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"steps[x].matches[i]\u548csteps[x].matches[j]"),"\u4e4b\u95f4\u5177\u6709",(0,r.kt)("strong",{parentName:"li"},"\u6216"),"\u5173\u7cfb\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"steps[x].matches[y].headers[i]\u548csteps[x].matches[y].header[j]"),"\u4e4b\u95f4\u5177\u6709",(0,r.kt)("strong",{parentName:"li"},"\u4e14"),"\u5173\u7cfb\u3002")),(0,r.kt)("h3",{id:"rollout\u7684\u7279\u6b8a\u6ce8\u91ca\u53ef\u9009"},"Rollout\u7684\u7279\u6b8a\u6ce8\u91ca\uff08\u53ef\u9009\uff09"),(0,r.kt)("p",null,"Rollout\u4e2d\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u6ce8\u91ca\uff0c\u7528\u4e8e\u542f\u7528\u7279\u5b9a\u529f\u80fd\u3002"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u6ce8\u91ca"),(0,r.kt)("th",{parentName:"tr",align:null},"\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"rollouts.kruise.io/rolling-type")),(0,r.kt)("td",{parentName:"tr",align:null},'"canary"\u6216"partition"'),(0,r.kt)("td",{parentName:"tr",align:null},'"canary"'),(0,r.kt)("td",{parentName:"tr",align:null},'"canary"\u8868\u793a\u4f7f\u7528\u91d1\u4e1d\u96c0\u5347\u7ea7\u7b56\u7565\u8fdb\u884cDeployment\uff1b"partition"\u8868\u793a\u4f7f\u7528\u591a\u6279\u6b21\u5347\u7ea7\u7b56\u7565\u8fdb\u884cDeployment\uff1b')))),(0,r.kt)("h3",{id:"\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u6b8a\u6ce8\u91ca\u53ef\u9009"},"\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7279\u6b8a\u6ce8\u91ca\uff08\u53ef\u9009\uff09"),(0,r.kt)("p",null,"\u7ed1\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u6ce8\u91ca\uff0c\u7528\u4e8e\u542f\u7528\u7279\u5b9a\u529f\u80fd\u3002"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u6ce8\u91ca"),(0,r.kt)("th",{parentName:"tr",align:null},"\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"rollouts.kruise.io/rollout-id")),(0,r.kt)("td",{parentName:"tr",align:null},"\u4efb\u610f\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fd9\u4e2a\u6982\u5ff5\u7c7b\u4f3c\u4e8e\u53d1\u5e03\u987a\u5e8f\u53f7\u3002\u7528\u4e8e\u89e3\u51b3\u7528\u6237\u662f\u5426\u89c2\u5bdf\u5230Kruise Rollout\u63a7\u5236\u5668\u5f53\u524d\u5de5\u4f5c\u8d1f\u8f7d\u66f4\u6539\u7684\u95ee\u9898\u3002")))),(0,r.kt)("h3",{id:"\u60a8\u5e94\u8be5\u4e86\u89e3\u7684rollout\u72b6\u6001"},"\u60a8\u5e94\u8be5\u4e86\u89e3\u7684Rollout\u72b6\u6001"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'kind: Rollout\nstatus:\n  phase: Healthy\n  observedGeneration: 2\n  canaryStatus:\n    canaryReplicas: 10\n    canaryReadyReplicas: 10\n    canaryRevision: 76fd76f75b\n    currentStepIndex: 3\n    currentStepState: Completed\n    observedRolloutID: "20230313093823"\n    observedWorkloadGeneration: 20\n    podTemplateHash: 76fd76f75b\n    stableRevision: b76b6f48f\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5b57\u6bb5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,r.kt)("th",{parentName:"tr",align:null},"\u6a21\u5f0f"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"phase")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},'"Initial" \u8868\u793a\u6ca1\u6709\u7ed1\u5b9a\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff1b"Healthy" \u8868\u793a\u7ed1\u5b9a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u5df2\u63a8\u8fdb\uff1b"Progressing" \u8868\u793a\u5377\u51fa\u6b63\u5728\u8fdb\u884c\u4e2d\u3002')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"observedGeneration")),(0,r.kt)("td",{parentName:"tr",align:null},"\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u89c2\u5bdf\u5230\u7684\u5377\u51fa\u89c4\u8303\u7684\u751f\u6210\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus")),(0,r.kt)("td",{parentName:"tr",align:null},"*\u5bf9\u8c61"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6709\u5173\u5377\u51fa\u8fdb\u5c55\u7684\u4fe1\u606f\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.canaryReplicas")),(0,r.kt)("td",{parentName:"tr",align:null},"\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u66f4\u65b0\u7684\u526f\u672c\u6570\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.canaryReadyReplicas")),(0,r.kt)("td",{parentName:"tr",align:null},"\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u66f4\u65b0\u7684\u5c31\u7eea\u526f\u672c\u6570\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.podTemplateHash")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u4f5c\u8d1f\u8f7d\u66f4\u65b0\uff08\u65b0\u7248\u672c\uff09\u7684\u54c8\u5e0c\u503c\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.canaryRevision")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7531Kruise Rollout\u63a7\u5236\u5668\u8ba1\u7b97\u7684\u5de5\u4f5c\u8d1f\u8f7d\u66f4\u65b0\uff08\u65b0\u7248\u672c\uff09\u7684\u4fee\u8ba2\u54c8\u5e0c\u503c\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.stableRevision")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8fdb\u5c55\u4e4b\u524d\u8bb0\u5f55\u7684\u5de5\u4f5c\u8d1f\u8f7d\u7a33\u5b9a\uff08\u65e7\u7248\u672c\uff09\u7684\u4fee\u8ba2\u54c8\u5e0c\u503c\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.observedRolloutID")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u5e94\u4e8e\u5de5\u4f5c\u8d1f\u8f7d\u7684",(0,r.kt)("inlineCode",{parentName:"td"},"rollouts.kruise.io/rollout-id"),"\u6ce8\u91ca\u3002\u5982\u679c\u5b83\u4eec\u76f8\u7b49\uff0c\u610f\u5473\u7740\u5377\u51fa\u63a7\u5236\u5668\u89c2\u5bdf\u5230\u4e86\u5de5\u4f5c\u8d1f\u8f7d\u7684\u66f4\u6539\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.currentStepIndex")),(0,r.kt)("td",{parentName:"tr",align:null},"\u6574\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5377\u51fa\u5f53\u524d\u6b65\u9aa4\u7d22\u5f15\u3002\u4ece1\u5f00\u59cb\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"canaryStatus.currentStepState")),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b57\u7b26\u4e32"),(0,r.kt)("td",{parentName:"tr",align:null},"\u53ea\u8bfb\u548c\u5199\u5165"),(0,r.kt)("td",{parentName:"tr",align:null},'\u5377\u51fa\u5f53\u524d\u6b65\u9aa4\u72b6\u6001\u3002"StepReady"\u548c"Complete"\u90fd\u8868\u793a\u5f53\u524d\u6b65\u9aa4\u5c31\u7eea\u3002')))))}s.isMDXComponent=!0}}]);