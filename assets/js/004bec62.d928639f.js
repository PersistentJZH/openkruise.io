"use strict";(self.webpackChunkopenkruise_io=self.webpackChunkopenkruise_io||[]).push([[7759],{3905:function(e,n,r){r.d(n,{Zo:function(){return u},kt:function(){return d}});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function o(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=t.createContext({}),c=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):o(o({},n),e)),r},u=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(r),d=a,f=p["".concat(l,".").concat(d)]||p[d]||m[d]||s;return r?t.createElement(f,o(o({ref:n},u),{},{components:r})):t.createElement(f,o({ref:n},u))}));function d(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=r.length,o=new Array(s);o[0]=p;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var c=2;c<s;c++)o[c]=r[c];return t.createElement.apply(null,o)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},4556:function(e,n,r){r.r(n),r.d(n,{assets:function(){return u},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return m}});var t=r(7462),a=r(3366),s=(r(7294),r(3905)),o=["components"],i={},l="Deploy Gameservers",c={unversionedId:"user-manuals/deploy-gameservers",id:"user-manuals/deploy-gameservers",title:"Deploy Gameservers",description:"\u201cHello World\u201d of OKG",source:"@site/kruisegame/user-manuals/deploy-gameservers.md",sourceDirName:"user-manuals",slug:"/user-manuals/deploy-gameservers",permalink:"/kruisegame/user-manuals/deploy-gameservers",draft:!1,tags:[],version:"current",lastUpdatedBy:"ChrisLiu",lastUpdatedAt:1705651230,formattedLastUpdatedAt:"1/19/2024",frontMatter:{},sidebar:"kruisegame",previous:{title:"Design Concept",permalink:"/kruisegame/design-concept"},next:{title:"Hot Update",permalink:"/kruisegame/user-manuals/hot-update"}},u={},m=[{value:"\u201cHello World\u201d of OKG",id:"hello-world-of-okg",level:2},{value:"ID awareness",id:"id-awareness",level:2}],p={toc:m};function d(e){var n=e.components,r=(0,a.Z)(e,o);return(0,s.kt)("wrapper",(0,t.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"deploy-gameservers"},"Deploy Gameservers"),(0,s.kt)("h2",{id:"hello-world-of-okg"},"\u201cHello World\u201d of OKG"),(0,s.kt)("p",null,"You can use GameServerSet to deploy game servers. A simple deployment case is as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"cat <<EOF | kubectl apply -f -\napiVersion: game.kruise.io/v1alpha1\nkind: GameServerSet\nmetadata:\n  name: minecraft\n  namespace: default\nspec:\n  replicas: 3\n  updateStrategy:\n    rollingUpdate:\n      podUpdatePolicy: InPlaceIfPossible\n  gameServerTemplate:\n    spec:\n      containers:\n        - image: registry.cn-hangzhou.aliyuncs.com/acs/minecraft-demo:1.12.2\n          name: minecraft\nEOF\n")),(0,s.kt)("p",null,"After the GameServerSet is created, three game servers and three corresponding pods appear in the cluster, because the specified number of replicas is 3."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get gss\nNAME        AGE\nminecraft   9s\n\nkubectl get gs\nNAME          STATE   OPSSTATE   DP    UP   AGE\nminecraft-0   Ready   None       0     0    10s\nminecraft-1   Ready   None       0     0    10s\nminecraft-2   Ready   None       0     0    10s\n\nkubectl get pod\nNAME            READY   STATUS    RESTARTS   AGE\nminecraft-0     1/1     Running   0          10s\nminecraft-1     1/1     Running   0          10s\nminecraft-2     1/1     Running   0          10s\n")),(0,s.kt)("h2",{id:"id-awareness"},"ID awareness"),(0,s.kt)("p",null,"Due to the stateful nature of game servers, they usually need unique identifiers to distinguish each other. This is why the name of the GameServer managed by GameServerSet ends with an ID number."),(0,s.kt)("p",null,"In some cases, the game server business itself needs to be aware of its own ID, which can be used as a regional server attribute mark or a basis for configuration management.\nAt this time, the corresponding identification ID can be sunk into the container through DownwardAPI. Here's an example:"),(0,s.kt)("p",null,"Deploy a GameServerSet, and the environment variable GS_NAME in the generated game server container will have the corresponding name as its value:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: game.kruise.io/v1alpha1\nkind: GameServerSet\nmetadata:\n  name: minecraft\n  namespace: default\nspec:\n  replicas: 3\n  updateStrategy:\n    rollingUpdate:\n      podUpdatePolicy: InPlaceIfPossible\n  gameServerTemplate:\n    spec:\n      containers:\n        - image: registry.cn-hangzhou.aliyuncs.com/acs/minecraft-demo:1.12.2\n          name: minecraft\n          env:\n          - name: GS_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n")),(0,s.kt)("p",null,"3 game servers will be generated:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get gs\nNAME          STATE   OPSSTATE   DP    UP    AGE\nminecraft-0   Ready   None       0     0     31s\nminecraft-1   Ready   None       0     0     31s\nminecraft-2   Ready   None       0     0     31s\n")),(0,s.kt)("p",null,"Check the GS_NAME environment variables of these three game servers separately and find that the GS_NAME of the three game servers corresponds to their own names."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl exec  minecraft-0 -- env | grep GS_NAME\nGS_NAME=minecraft-0\n\nkubectl exec  minecraft-1 -- env | grep GS_NAME\nGS_NAME=minecraft-1\n\nkubectl exec  minecraft-2 -- env | grep GS_NAME\nGS_NAME=minecraft-2\n")),(0,s.kt)("p",null,"In this way, the game program can perform configuration management and other operations by parsing the GS_NAME environment variable when it is started."))}d.isMDXComponent=!0}}]);